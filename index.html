<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë²•ì •ê°ì—¼ë³‘ ì•”ê¸° ê²Œì„</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nanum+Gothic&display=swap');

        body {
            font-family: 'Nanum Gothic', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f7ff;
            color: #333;
        }

        #game-container {
            width: 95%;
            max-width: 600px;
            padding: 25px;
            background-color: #ffffff;
            border-radius: 15px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        h1, h2 {
            color: #0056b3;
        }

        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 8px;
            transition: background-color 0.3s, transform 0.2s;
        }

        button:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }

        .hidden {
            display: none;
        }

        #question-screen h2 {
            margin: 20px 0;
            font-size: 28px;
            min-height: 80px;
        }

        #feedback {
            margin-top: 20px;
            font-size: 20px;
            font-weight: bold;
            height: 30px;
        }

        #progress {
            margin-top: 15px;
            font-size: 16px;
            color: #555;
        }

        #result-screen h2, #ranking-screen h2 {
            font-size: 24px;
            margin-bottom: 20px;
        }

        #emoji-selection {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }

        .emoji-btn {
            font-size: 28px;
            padding: 10px;
            background-color: #e9ecef;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: border-color 0.3s, transform 0.2s;
        }

        .emoji-btn:hover {
            transform: scale(1.1);
        }
        
        .emoji-btn.selected {
            border-color: #007bff;
        }

        #ranking-list {
            list-style: none;
            padding: 0;
            max-height: 300px;
            overflow-y: auto;
        }

        #ranking-list li {
            background-color: #f8f9fa;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 5px;
            font-size: 18px;
            display: flex;
            justify-content: space-between;
        }

        .mode-selection button, .question-count-selection button {
             width: 150px;
        }

    </style>
</head>
<body>

    <div id="game-container">
        <div id="start-screen">
            <h1>ë²•ì •ê°ì—¼ë³‘ ì•”ê¸° ê²Œì„ ğŸ¦ </h1>
            <h2>ëª¨ë“œ ì„ íƒ</h2>
            <div class="mode-selection">
                <button onclick="selectMode('practice')">ì—°ìŠµ ëª¨ë“œ</button>
                <button onclick="selectMode('challenge')">ë„ì „ ëª¨ë“œ</button>
            </div>
            <div id="question-count-selection" class="hidden">
                <h2>ë¬¸ì œ ìˆ˜ ì„ íƒ</h2>
                <button onclick="startGame(20)">20ë¬¸ì œ</button>
                <button onclick="startGame(40)">40ë¬¸ì œ</button>
            </div>
        </div>

        <div id="emoji-selection-screen" class="hidden">
            <h2>ë­í‚¹ì— ì‚¬ìš©í•  ì´ëª¨ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”!</h2>
            <div id="emoji-selection"></div>
            <button onclick="confirmEmojiAndStart()">ì„ íƒ ì™„ë£Œ</button>
        </div>

        <div id="question-screen" class="hidden">
            <p id="progress"></p>
            <h2 id="question"></h2>
            <div>
                <button onclick="checkAnswer(1)">1ê¸‰</button>
                <button onclick="checkAnswer(2)">2ê¸‰</button>
                <button onclick="checkAnswer(3)">3ê¸‰</button>
            </div>
            <p id="feedback"></p>
        </div>

        <div id="result-screen" class="hidden">
            <h2>ê²Œì„ ì¢…ë£Œ!</h2>
            <p id="final-score"></p>
            <button onclick="restartGame()">ì²˜ìŒìœ¼ë¡œ</button>
            <button onclick="showRanking()">ë­í‚¹ ë³´ê¸°</button>
        </div>

        <div id="ranking-screen" class="hidden">
            <h2>ğŸ† ë„ì „ ëª¨ë“œ ë­í‚¹ ğŸ†</h2>
            <ol id="ranking-list"></ol>
            <button onclick="restartGame()">ì²˜ìŒìœ¼ë¡œ</button>
        </div>
    </div>

    <script>
        const diseases = [
            { name: 'ì—ë³¼ë¼ë°”ì´ëŸ¬ìŠ¤ë³‘', class: 1 }, { name: 'ë§ˆë²„ê·¸ì—´', class: 1 }, { name: 'ë¼ì‹¸ì—´', class: 1 },
            { name: 'í¬ë¦¬ë¯¸ì•ˆì½©ê³ ì¶œí˜ˆì—´', class: 1 }, { name: 'ë‚¨ì•„ë©”ë¦¬ì¹´ì¶œí˜ˆì—´', class: 1 }, { name: 'ë¦¬í”„íŠ¸ë°¸ë¦¬ì—´', class: 1 },
            { name: 'ë‘ì°½', class: 1 }, { name: 'í˜ìŠ¤íŠ¸', class: 1 }, { name: 'íƒ„ì €', class: 1 },
            { name: 'ë³´íˆ´ë¦¬ëˆ”ë…ì†Œì¦', class: 1 }, { name: 'ì•¼í† ë³‘', class: 1 }, { name: 'ì‹ ì¢…ê°ì—¼ë³‘ì¦í›„êµ°', class: 1 },
            { name: 'ì¤‘ì¦ê¸‰ì„±í˜¸í¡ê¸°ì¦í›„êµ°(SARS)', class: 1 }, { name: 'ì¤‘ë™í˜¸í¡ê¸°ì¦í›„êµ°(MERS)', class: 1 },
            { name: 'ë™ë¬¼ì¸í”Œë£¨ì—”ì ì¸ì²´ê°ì—¼ì¦', class: 1 }, { name: 'ì‹ ì¢…ì¸í”Œë£¨ì—”ì', class: 1 }, { name: 'ë””í”„í…Œë¦¬ì•„', class: 1 },
            { name: 'ê²°í•µ', class: 2 }, { name: 'ìˆ˜ë‘', class: 2 }, { name: 'í™ì—­', class: 2 }, { name: 'ì½œë ˆë¼', class: 2 },
            { name: 'ì¥í‹°í‘¸ìŠ¤', class: 2 }, { name: 'íŒŒë¼í‹°í‘¸ìŠ¤', class: 2 }, { name: 'ì„¸ê· ì„±ì´ì§ˆ', class: 2 },
            { name: 'ì¥ì¶œí˜ˆì„±ëŒ€ì¥ê· ê°ì—¼ì¦', class: 2 }, { name: 'Aí˜•ê°„ì—¼', class: 2 }, { name: 'ë°±ì¼í•´', class: 2 },
            { name: 'ìœ í–‰ì„±ì´í•˜ì„ ì—¼', class: 2 }, { name: 'í’ì§„', class: 2 }, { name: 'í´ë¦¬ì˜¤', class: 2 },
            { name: 'ìˆ˜ë§‰êµ¬ê·  ê°ì—¼ì¦', class: 2 }, { name: 'bí˜•í—¤ëª¨í•„ë£¨ìŠ¤ì¸í”Œë£¨ì—”ì', class: 2 }, { name: 'íë ´êµ¬ê·  ê°ì—¼ì¦', class: 2 },
            { name: 'í•œì„¼ë³‘', class: 2 }, { name: 'ì„±í™ì—´', class: 2 }, { name: 'ë°˜ì½”ë§ˆì´ì‹ ë‚´ì„±í™©ìƒ‰í¬ë„ì•Œê· (VRSA) ê°ì—¼ì¦', class: 2 },
            { name: 'ì¹´ë°”í˜ë„´ë‚´ì„±ì¥ë‚´ì„¸ê· ì†ê· ì¢…(CRE) ê°ì—¼ì¦', class: 2 }, { name: 'Eí˜•ê°„ì—¼', class: 2 },
            { name: 'íŒŒìƒí’', class: 3 }, { name: 'Bí˜•ê°„ì—¼', class: 3 }, { name: 'ì¼ë³¸ë‡Œì—¼', class: 3 }, { name: 'Cí˜•ê°„ì—¼', class: 3 },
            { name: 'ë§ë¼ë¦¬ì•„', class: 3 }, { name: 'ë ˆì§€ì˜¤ë„¬ë¼ì¦', class: 3 }, { name: 'ë¹„ë¸Œë¦¬ì˜¤íŒ¨í˜ˆì¦', class: 3 },
            { name: 'ë°œì§„í‹°í‘¸ìŠ¤', class: 3 }, { name: 'ë°œì§„ì—´', class: 3 }, { name: 'ì¯”ì¯”ê°€ë¬´ì‹œì¦', class: 3 },
            { name: 'ë ™í† ìŠ¤í”¼ë¼ì¦', class: 3 }, { name: 'ë¸Œë£¨ì…€ë¼ì¦', class: 3 }, { name: 'ê³µìˆ˜ë³‘', class: 3 },
            { name: 'ì‹ ì¦í›„êµ°ì¶œí˜ˆì—´', class: 3 }, { name: 'í›„ì²œì„±ë©´ì—­ê²°í•ì¦(AIDS)', class: 3 },
            { name: 'í¬ë¡œì´ì¸ í íŠ¸-ì•¼ì½¥ë³‘(CJD) ë° ë³€ì¢…í¬ë¡œì´ì¸ í íŠ¸-ì•¼ì½¥ë³‘(vCJD)', class: 3 }, { name: 'í™©ì—´', class: 3 },
            { name: 'ë…ê¸°ì—´', class: 3 }, { name: 'íì—´', class: 3 }, { name: 'ì›¨ìŠ¤íŠ¸ë‚˜ì¼ì—´', class: 3 },
            { name: 'ë¼ì„ë³‘', class: 3 }, { name: 'ì§„ë“œê¸°ë§¤ê°œë‡Œì—¼', class: 3 }, { name: 'ìœ ë¹„ì €', class: 3 },
            { name: 'ì¹˜ì¿¤êµ¬ë‹ˆì•¼ì—´', class: 3 }, { name: 'ì¤‘ì¦ì—´ì„±í˜ˆì†ŒíŒê°ì†Œì¦í›„êµ°(SFTS)', class: 3 },
            { name: 'ì§€ì¹´ë°”ì´ëŸ¬ìŠ¤ ê°ì—¼ì¦', class: 3 }, { name: 'ì— í­ìŠ¤', class: 3 }, { name: 'ë§¤ë…', class: 3 }
        ];

        const emojis = ['â¤ï¸', 'ğŸ', 'ğŸ¶', 'ğŸ›', 'ğŸ¦Š', 'ğŸ€', 'ğŸš€', 'â­', 'ğŸ¤–', 'ğŸ‘»', 'ğŸ‘‘', 'ğŸ’¡'];

        let currentMode = '';
        let totalQuestions = 0;
        let score = 0;
        let currentQuestionIndex = 0;
        let questions = [];
        let selectedEmoji = '';
        
        const startScreen = document.getElementById('start-screen');
        const questionCountSelection = document.getElementById('question-count-selection');
        const emojiSelectionScreen = document.getElementById('emoji-selection-screen');
        const questionScreen = document.getElementById('question-screen');
        const resultScreen = document.getElementById('result-screen');
        const rankingScreen = document.getElementById('ranking-screen');
        const feedbackEl = document.getElementById('feedback');
        const progressEl = document.getElementById('progress');

        function selectMode(mode) {
            currentMode = mode;
            questionCountSelection.classList.remove('hidden');
        }

        function startGame(num) {
            totalQuestions = num;
            if (currentMode === 'challenge') {
                setupEmojiSelection();
                startScreen.classList.add('hidden');
                emojiSelectionScreen.classList.remove('hidden');
            } else {
                startScreen.classList.add('hidden');
                questionScreen.classList.remove('hidden');
                initializeGame();
            }
        }

        function setupEmojiSelection() {
            const container = document.getElementById('emoji-selection');
            container.innerHTML = '';
            emojis.forEach(emoji => {
                const btn = document.createElement('span');
                btn.className = 'emoji-btn';
                btn.textContent = emoji;
                btn.onclick = () => {
                    document.querySelectorAll('.emoji-btn').forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    selectedEmoji = emoji;
                };
                container.appendChild(btn);
            });
        }

        function confirmEmojiAndStart() {
            if (!selectedEmoji) {
                alert('ì´ëª¨ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!');
                return;
            }
            emojiSelectionScreen.classList.add('hidden');
            questionScreen.classList.remove('hidden');
            initializeGame();
        }

        function initializeGame() {
            score = 0;
            currentQuestionIndex = 0;
            questions = [...diseases].sort(() => 0.5 - Math.random()).slice(0, totalQuestions);
            displayQuestion();
        }

        function displayQuestion() {
            if (currentQuestionIndex < totalQuestions) {
                progressEl.textContent = `ë¬¸ì œ ${currentQuestionIndex + 1} / ${totalQuestions}`;
                document.getElementById('question').textContent = questions[currentQuestionIndex].name;
                feedbackEl.textContent = '';
                document.querySelectorAll('#question-screen button').forEach(btn => btn.disabled = false);
            } else {
                endGame();
            }
        }

        function checkAnswer(selectedClass) {
            document.querySelectorAll('#question-screen button').forEach(btn => btn.disabled = true);
            const correctClass = questions[currentQuestionIndex].class;
            if (selectedClass === correctClass) {
                score++;
                feedbackEl.textContent = 'ì •ë‹µì…ë‹ˆë‹¤! âœ…';
                feedbackEl.style.color = 'green';
            } else {
                feedbackEl.textContent = `ì˜¤ë‹µì…ë‹ˆë‹¤. (ì •ë‹µ: ${correctClass}ê¸‰) âŒ`;
                feedbackEl.style.color = 'red';
            }
            
            currentQuestionIndex++;
            setTimeout(displayQuestion, 1500);
        }

        function endGame() {
            questionScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            document.getElementById('final-score').textContent = `ì´ ${totalQuestions}ë¬¸ì œ ì¤‘ ${score}ë¬¸ì œë¥¼ ë§í˜”ìŠµë‹ˆë‹¤!`;

            if (currentMode === 'challenge') {
                saveRanking();
            }
        }
        
        function getRankings() {
            const rankings = localStorage.getItem('infectionGameRankings');
            return rankings ? JSON.parse(rankings) : [];
        }

        function saveRanking() {
            const rankings = getRankings();
            let finalName = selectedEmoji;
            
            // ì¤‘ë³µ ì´ë¦„ ì²˜ë¦¬
            const existingNames = rankings.map(r => r.name);
            let count = 1;
            while(existingNames.includes(finalName)) {
                count++;
                finalName = `${selectedEmoji} (${count})`;
            }

            rankings.push({ name: finalName, score: score, total: totalQuestions });
            rankings.sort((a, b) => b.score - a.score || a.total - b.total);
            
            localStorage.setItem('infectionGameRankings', JSON.stringify(rankings));
        }

        function showRanking() {
            resultScreen.classList.add('hidden');
            rankingScreen.classList.remove('hidden');

            const rankingList = document.getElementById('ranking-list');
            rankingList.innerHTML = '';
            const rankings = getRankings();

            if (rankings.length === 0) {
                rankingList.innerHTML = '<li>ì•„ì§ ë­í‚¹ì´ ì—†ìŠµë‹ˆë‹¤.</li>';
            } else {
                rankings.forEach((entry, index) => {
                    const li = document.createElement('li');
                    li.innerHTML = `<span>${index + 1}. ${entry.name}</span> <span>${entry.score} / ${entry.total}</span>`;
                    rankingList.appendChild(li);
                });
            }
        }

        function restartGame() {
            resultScreen.classList.add('hidden');
            rankingScreen.classList.add('hidden');
            startScreen.classList.remove('hidden');
            questionCountSelection.classList.add('hidden');
            selectedEmoji = '';
        }

    </script>
</body>
</html>
